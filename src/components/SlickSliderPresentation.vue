<!-- WIP -->
<template>
    <div id="ComeFunzionaContainer">
        <div class="slider-container slideshow-box-hp" id="ComeFunziona">
        <div class="slideshow-cards">
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">settings</span></p>
                    <div class="slider-card-text">
                        <h1>Come funziona<span class="slider-primary">?</span></h1>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">local_offer</span></p>
                    <div class="slider-card-text">
                        <h2>Inserisci la keyword</h2>
                        <p>Inserisci le parole chiavi che ti riguardano</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">event_available</span></p>
                    <div class="slider-card-text">
                        <h2>Nuovo evento</h2>
                        <p>Cerchiamo automaticamente sul calendario giornaliero</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">error_outline</span></p>
                    <div class="slider-card-text">
                        <h2>Ti avvisiamo</h2>
                        <p>Se ci sono eventi o variazioni che ti interessano</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">notifications</span></p>
                    <div class="slider-card-text">
                        <h2 class="sliderTitolo">Tipi di notifiche</h2>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">send</span></p>
                    <div class="slider-card-text">
                        <h2>Daily Notification</h2>
                        <p>Notifica che racchiude gli eventi e le variazioni in programma</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">hourglass_top</span></p>
                    <div class="slider-card-text">
                        <h2>Last Minute Notification</h2>
                        <p>Notifica istantanea per eventi o modifiche aggiunti durante la giornata</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">explore</span></p>
                    <div class="slider-card-text">
                        <h2 class="sliderTitolo">Esplora le funzionalit&agrave;</h2>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">search</span></p>
                    <div class="slider-card-text">
                        <h2>Cerca Eventi</h2>
                        <p>Cerca gli eventi e le variazioni dell'orario previsti per i prossimi 3 giorni</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">tune</span></p>
                    <div class="slider-card-text">
                        <h2>Personalizza i canali</h2>
                        <p>Scegli quale canale di comunicazione preferisci</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">send</span></p>
                    <div class="slider-card-text">
                        <h2>Telegram</h2>
                        <p>Ti avvisiamo tramite il nostro bot su Telegram</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">email</span></p>
                    <div class="slider-card-text">
                        <h2>Email</h2>
                        <p>Ti avvisiamo con una semplice ed efficace email</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card">
                    <p class="slider-card-icon"><span class="material-symbols-outlined">help_outline</span></p>
                    <div class="slider-card-text">
                        <h2>Dubbi<span class="slider-primary">?</span></h2>
                        <p>Visita la FAQ o contattaci</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="content-card" style="grid-template-columns: 1fr;">
                    <svg version="1.1" viewBox="0 0 90 94" xmlns="http://www.w3.org/2000/svg" style="max-width: 60%; max-height: 60%; transform: translateX(3px) translateY(-3px);" class="logo">
                        <circle cx="78.77" cy="10.95" r="9.6" fill="#f00" class="logo-dot"/>
                        <path d="m69.13 6.05q-1.12 2.84-1.22 4.98-23.81-0.06-47.69-0.02-5.01 0.01-7.39 0.95c-5.43 2.15-7.88 7.02-7.87 12.82q0.05 26.12 0.02 52.89c-0.01 4.61 2.96 9.12 7.14 11.07q3.04 1.41 8.03 1.34 22.75-0.29 45.07 0.03c5.33 0.07 10.08-2.31 12.57-7.22q1.22-2.4 1.22-9.96-0.02-25.46-0.01-50.89 2.85-0.18 4.99-1.26 0.03 26.51-0.01 53.1-0.01 7.2-1.44 10.54-2.77 6.48-9.95 9.58h-61.18q-9.66-4.17-11.41-14.59v-57.96q2.05-10.48 10.83-14.07 3.38-1.38 10.02-1.38 24-0.03 48.28 0.05z"/>
                        <path d="m35.99 36.36 0.03 7.02a0.36 0.36 0 0 0 0.36 0.36h27.26a0.36 0.36 0 0 1 0.36 0.36l-0.01 10.28a0.36 0.36 0 0 1-0.36 0.36h-27.27a0.36 0.36 0 0 0-0.36 0.36v18.55a0.36 0.36 0 0 1-0.36 0.36l-14.76-0.02a0.36 0.36 0 0 1-0.36-0.36v-47.75a0.36 0.36 0 0 1 0.36-0.36h42.75a0.36 0.36 0 0 1 0.36 0.36l0.02 9.76a0.36 0.36 0 0 1-0.36 0.36h-27.3a0.36 0.36 0 0 0-0.36 0.36z"/>
                    </svg>
                </div>
            </div>

        </div>

        </div>
    </div>
</template>

<script>
import $ from 'jquery';

export default {
    name: 'SlickSliderPresentation',
    data() {
        return {
            usingSlick: false,
            mouseDownHandler: null,
            mouseUpHandler: null,
        };
    },
    async mounted() {
        // expose jQuery globally so the plugin can attach correctly
        window.$ = window.jQuery = $;

        // dynamically import the local slick plugin after setting window.jQuery
        try {
            await import(/* @vite-ignore */ '../utils/slick.min.js');
        } catch (err) {
            // eslint-disable-next-line no-console
            console.error('Failed to load slick plugin:', err);
            return;
        }

        this.$nextTick(() => {
            const $cards = $(this.$el).find('.slideshow-cards');
            if (!$cards || typeof $cards.slick !== 'function') {
                // eslint-disable-next-line no-console
                console.warn('Slick plugin not available on jQuery');
                return;
            }

            $cards.slick({
                dots: false,
                infinite: false,
                speed: 500,
                slidesToShow: 3,
                slidesToScroll: 1,
                easing: 'easeOut',
                centerMode: true,
                responsive: [
                    {
                        breakpoint: 1200,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 1,
                            dots: false,
                            centerMode: false,
                        },
                    },
                    {
                        breakpoint: 900,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            dots: false,
                            centerMode: false,
                        },
                    },
                ],
            });

            this.usingSlick = true;

            // Add mouse down/up helpers similar to previous behavior
            const track = $cards.find('.slick-list .slick-track');
            this.mouseDownHandler = () => $cards.addClass('mousedown');
            this.mouseUpHandler = () => $cards.removeClass('mousedown');
            track.on('mousedown', this.mouseDownHandler);
            $(document).on('mouseup', this.mouseUpHandler);
        });
    },
    beforeUnmount() {
        const $cards = $(this.$el).find('.slideshow-cards');
        if (this.usingSlick && $cards && typeof $cards.slick === 'function' && $cards.hasClass('slick-initialized')) {
            try {
                $cards.slick('unslick');
            } catch (e) {
                // ignore
            }
        }

        if (this.mouseDownHandler) {
            $(this.$el).find('.slick-list .slick-track').off('mousedown', this.mouseDownHandler);
        }
        if (this.mouseUpHandler) {
            $(document).off('mouseup', this.mouseUpHandler);
        }
    },
};
</script>
<style scoped src="@/assets/css/faq.css"></style>
<style scoped src="@/assets/css/slick-slider.css"></style>